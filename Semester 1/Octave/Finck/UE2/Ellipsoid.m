% ellipsoid function% author : Daniel Griesser function [f,g] = Ellipsoid(x, A)  % input:  % x - vector in column form   % A - matrix  % output:  % f - function value [1x1]   % g - gradient vector [nx1]    % check input  n = size(x, 1);  [rows, cols] = size(A);    if n == 1    fprintf('input is row vector, transform it into column vector\n')    x = x';     n = size(x, 1);  endif    if rows != cols || rows != n    printf('%d x %d matrix and %d-dimensions vector\n', rows, cols, n);    error('input matrix error: incorrect dimensions\n');  endif    % function value   f = x'*A*x;    % gradient vector   g = zeros(n, 1); % create n x 1 matrix filled with 0s  for j = 1:n    for i = 1:n      if i == j        g(j, 1) += 2 * x(j) * A(j, i);      else         g(j, 1) += x(i) * (A(j, i) + A(i, j));      endif    endfor  endfor  endfunction